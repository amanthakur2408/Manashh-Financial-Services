<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SIP Calculator | Manashh Financial Services</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="calculator.css">
</head>

<body class="calculator-page">

<!-- HEADER -->
<div class="calculator-header">
  <a href="index.html" class="back-home">‚Üê Back to Home</a>
  <img src="images/logo.png" class="calculator-logo" alt="Manashh Logo">
</div>

<!-- CONTENT -->
<div class="container">
  <div class="card">
    <h1>SIP Calculator</h1>
    <p>Enter details to calculate your investment returns.</p>

    <!-- INPUTS -->
    <div class="calculator">
      <input type="number" id="amount" placeholder="Monthly Investment (‚Çπ)">
      <input type="number" id="years" placeholder="Investment Duration (Years)">
      <input type="number" id="rate" placeholder="Expected Return (%)">

      <button onclick="calculateSIP()">Calculate</button>

      <!-- RESULT -->
     <div class="result" id="result" style="margin-top:20px; display:none;">
  <div class="result-grid">

    <div>
      <p>Total Invested: ‚Çπ<span id="invested">0</span></p>
      <p>Estimated Returns: ‚Çπ<span id="returns">0</span></p>
      <p style="font-size:20px;font-weight:600;color:#0b3c5d;">
        Final Corpus: ‚Çπ<span id="corpus">0</span>
      </p>
    </div>
<!-- LEAD FORM -->
<div class="lead-box" id="leadBox" style="display:none; margin-top:25px;">
  <h3>Get Your SIP Plan Reviewed by an Expert</h3>
  <p style="font-size:14px; color:#555;">
    Share your details & we‚Äôll help you optimize your investment.
  </p>

  <form id="clientForm">
    <input type="text" name="name" placeholder="Full Name" required>
    <input type="tel" name="mobile" placeholder="Mobile Number" required>
    <input type="email" name="email" placeholder="Email (Optional)">
    <!-- Hidden Calculation Data -->
    <input type="hidden" name="calculatorType" value="SIP">
    <input type="hidden" name="monthlyAmount" id="h_amount">
    <input type="hidden" name="years" id="h_years">
    <input type="hidden" name="rate" id="h_rate">
    <input type="hidden" name="totalInvested" id="h_invested">
    <input type="hidden" name="totalReturns" id="h_returns">
    <input type="hidden" name="finalCorpus" id="h_corpus">

    <button type="submit">üìû Request Callback</button>
  </form>

  <p style="font-size:12px; margin-top:10px; color:#777;">
    üîí We respect your privacy. No spam.
  </p>
</div>
    <!-- PIE -->
   <div class="pie" id="pie"></div>

<div class="pie-legend">
  <div class="legend-item">
    <span class="legend-color invest"></span> Investment
  </div>
  <div class="legend-item">
    <span class="legend-color return"></span> Returns
  </div>
</div>


  </div>
</div>

    </div>
  </div>
</div>

<script>
function calculateSIP() {
  const amount = Number(document.getElementById("amount").value);
  const years = Number(document.getElementById("years").value);
  const rate = Number(document.getElementById("rate").value);

  if (!amount || !years || !rate) {
    alert("Please enter all values");
    return;
  }

  const monthlyRate = rate / 100 / 12;
  const months = years * 12;

  const corpus =
    amount *
    ((Math.pow(1 + monthlyRate, months) - 1) / monthlyRate) *
    (1 + monthlyRate);

  const invested = amount * months;
  const returns = corpus - invested;

  // Display results
  document.getElementById("invested").innerText =
    Math.round(invested).toLocaleString();

  document.getElementById("returns").innerText =
    Math.round(returns).toLocaleString();

  document.getElementById("corpus").innerText =
    Math.round(corpus).toLocaleString();

  // Pie chart
  const investedAngle = (invested / corpus) * 360;
  document.getElementById("pie").style.background =
    `conic-gradient(
      #0b3c5d 0deg ${investedAngle}deg,
      #e1e7ec ${investedAngle}deg 360deg
    )`;

  // Fill hidden form values
  document.getElementById("h_amount").value = amount;
  document.getElementById("h_years").value = years;
  document.getElementById("h_rate").value = rate;
  document.getElementById("h_invested").value = Math.round(invested);
  document.getElementById("h_returns").value = Math.round(returns);
  document.getElementById("h_corpus").value = Math.round(corpus);

  document.getElementById("result").style.display = "block";
  document.getElementById("leadBox").style.display = "block";
}

/* SUBMIT LEAD */
document.getElementById("clientForm").addEventListener("submit", async function(e) {
  e.preventDefault();

  const formData = Object.fromEntries(
    new FormData(this).entries()
  );

  try {
    const res = await fetch("/api/save-lead", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(formData)
    });

    const data = await res.json();

    alert("Thank you! Our advisor will contact you shortly.");
    this.reset();

  } catch (err) {
    alert("Something went wrong. Please try again.");
  }
});
</script>
</body>
</html>
